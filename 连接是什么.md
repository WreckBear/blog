## ”TCP连接“究竟是什么意思？

> 我们经常听到"建立TCP连接"，"服务器的连接数量有限"等，但仔细一想，连接究竟是个什么东西，是和电话一样两端连起一根线？似乎有点抽象不是么？

### 1. 久违的分组交换网络

似乎这个概念只有在学校里学计算机网络才能接触到，但不过今天的话题其实和它离不开关系。我们知道最早的电话网络是以很容易理解的形式存在的，就是单纯的一根线加两端的设备，设备之间所沟通的所有信息都通过一根特定的电缆来回传输，如下图：

![](无标题.png)

这样的连接是我们特别好理解的，搭起两边的线，就是一个连接嘛！但是，我们讨论的是计算机网络！(严肃脸)，计算机网络中两个设备节点是如何通信？

![](无标题1.png)

计算机网络采取分组交换技术，什么意思呢？就是我有【一块数据】要发给对方小苍，那我会把这【一块数据】分成N份【单位数据】，分别发出去，而每份【单位数据】走哪条路是不一定的，但是这些【单位数据】总要全部达到小苍手里，小苍再根据【单位数据】里记录的序号拼接起来，组成完整的【一块数据】。这就是分组的意思所在。

### 2. 协议和协议实现

上面不小心把TCP的大体实现给说了，实际上在具体的应用中，光有大体思路是不行的，还有很多细节问题，需要两个设备之间提前约定好协议，才能协同完成通信。举个例子：A向B发了10份【单位数据】，而B其实只收到9份【单位数据】，怎么办？

TCP协议大家都应该是知道的，但协议只是想法，真正起作用的是在路由节点和设备节点上的协议软件，是运行在设备上的具体执行者，它根据协议指导，对具体数据进行控制和操作。这儿就不往下展开了。

认识到协议和协议软件这一点非常重要，因为连接的限制恰恰就是受软件在设备中资源分配的影响的。

### 3. 虚拟的连接

上面说的第一种电话网络，如果两个设备搭设了一条线，那么两个电话就一定确定对方在线，因为他俩独享一条实时存在的线。但计算机网络的连接呢？其实只是A向B问："你在么？",B回应:"我在啊！",A回应:"好的我知道了"，然后A跟B都认为对方在，就认为自己建立起了连接，同时两边都会为这个连接分配内存、CPU处理时间等资源，所以问题就在这里